<!doctype html>
<html lang="en">

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/images/small_logo.svg" />
    <title>GPM</title>
    <script type="module" src="/main.js"></script>
</head>

<body>
    <div id="wait-to-load" style="display:none;">
        <div id="upload" x-data="upload" x-init="loadData">
            <navigation-bar></navigation-bar>

            <div class="columns mt-4 mb-0">
                <div class="column">
                    <h3 class="title is-2 has-text-centered mb-0" x-text="'Upload: '+ (gwasUpload.study ? gwasUpload.study.name : '...')"></h3>
                    <p class="has-text-centered mb-0">
                        <span x-text="'Status: '+ (gwasUpload.study ? gwasUpload.study.status : '...')"></span>
                    </p>
                </div>
            </div>

            <div class="columns mt-0 is-centered" x-show="gwasUpload.study.status === 'failed'">
                <div class="columns mt-0 is-centered">
                    <h4 class="title">Upload failed</h4>
                    <br />
                    <p>Maybe give error message here?</p>
                </div>
            </div>
            <div class="columns mt-0 is-centered" x-show="gwasUpload.study.status === 'processing'">
                This may take a while...
            </div>
            <div class="columns mt-0 is-centered" x-show="gwasUpload.study.status === 'completed'">
                <div class="column is-11">
                    <table class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth">
                        <thead>
                            <tr>
                                <th><abbr title="Coloc Info">Coloc Info</abbr></th>
                                <th><abbr title="Trait">Trait</abbr></th>
                                <th><abbr title="Data Type">Data Type</abbr></th>
                                <th><abbr title="Gene">Gene</abbr></th>
                                <th><abbr title="Tissue">Tissue</abbr></th>
                                <th><abbr title="Cis/Trans">Cis/Trans</abbr></th>
                                <th><abbr title="P-value">P-value</abbr></th>
                            </tr>
                        </thead>
                        <tbody class="is-size-7">
                            <template x-for="[candidate_snp, colocs] in Object.entries(getDataForColocTable)">
                                    <template x-for="(coloc, colocIndex) in colocs">
                                            <tr x-bind:style="!!coloc.posterior_prob ? 'background-color: ' + coloc.color : ''">
                                                    <template x-if="colocIndex === 0 && !!coloc.posterior_prob">
                                                            <td x-bind:rowspan="colocs.length" style="width: 20%">
                                                                    Causal Variant: <a :href="'snp.html?id=' + coloc.snp_id" x-text="coloc.candidate_snp"></a>
                                                                    <br>
                                                                    LD Region: <a :href="'region.html?id=' + coloc.ld_block_id" x-text="coloc.ld_block"></a>
                                                                    <br>
                                                                    Posterior Probability (PP): <b x-text="coloc.posterior_prob.toFixed(3)"></b>
                                                                    <br>
                                                                    PP Explained by SNP: <b x-text="coloc.posterior_explained_by_snp.toFixed(3)"></b>
                                                            </td>
                                                    </template>
                                                    <template x-if="colocIndex === 0 && !coloc.posterior_prob">
                                                            <td x-bind:rowspan="colocs.length" style="width: 20%">
                                                                    LD Region: <a :href="'region.html?id=' + coloc.ld_block" x-text="coloc.ld_block"></a>
                                                                    <br>
                                                                    <b>No coloc evidence found.</b>
                                                            </td>
                                                    </template>
                                                    <td x-text="coloc.name ? coloc.name : coloc.trait" style="width:40%"></td>
                                                    <td x-text="coloc.data_type"></td>
                                                    <td><a :href="'gene.html?id=' + coloc.known_gene" x-text="coloc.known_gene"></a></td>
                                                    <td x-text="coloc.tissue"></td>
                                                    <td x-text="coloc.cis_trans"></td>
                                                    <td x-text="(coloc.min_p !== null ? coloc.min_p.toExponential(2) : '')"></td>
                                            </tr>
                                    </template>
                            </template>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</body>

</html> 